# 의도 기반 라우팅 규칙

> pm-orchestrator 및 CLAUDE.md에서 참조하는 공통 매핑 규칙

---

## 동사 패턴 매핑

### 검토 계열

| 키워드 | 컨텍스트 | 에이전트 | 설명 |
|--------|----------|----------|------|
| 검토해, 리뷰해, review | 코드, PR, 변경사항 | `code-reviewer` | 코드 품질/보안/성능 리뷰 |
| 검토해 | 아키텍처, 설계 | `architect` | 기술 설계 검토 |
| 검토해 | 스펙, 요구사항 | `spec-validator` | 스펙 완전성 검토 |

### 검증 계열

| 키워드 | 컨텍스트 | 에이전트 | 설명 |
|--------|----------|----------|------|
| 검증해, validate | 테스트, 품질, 커버리지 | `test-quality-validator` | 테스트 품질 검증 |
| 검증해 | 타입, 동기화, types | `type-sync-checker` | 타입 파일 동기화 검증 |
| 검증해 | 보안, 마스킹, 민감정보 | `security-validator` | 보안 규칙 검증 |
| 검증해 | API, 페이로드, 스키마 | `api-integration` | API 일관성 검증 |
| 검증해 | Vercel, 배포, import | `vercel-constraint-checker` | Vercel 제약 검증 |

### 확인 계열

| 키워드 | 컨텍스트 | 처리 방식 | 설명 |
|--------|----------|-----------|------|
| 확인해 | 에이전트, 상태 | `agent-manager` | 에이전트 생태계 상태 |
| 확인해 | 코드 존재, 구현 여부 | 직접 Grep/Read | 에이전트 불필요 |
| 확인해 | 파일, 구조 | 직접 Glob/Read | 에이전트 불필요 |
| 확인해 | 설정, 환경 | 직접 Read | 에이전트 불필요 |

---

## 구현/수정 계열

| 키워드 | 컨텍스트 | 에이전트 | 설명 |
|--------|----------|----------|------|
| 만들어줘, 구현해줘, 추가해줘 | 기능, 컴포넌트 | `pm-orchestrator` | 복잡도 분석 후 라우팅 |
| 고쳐줘, 수정해줘, 안돼 | 버그, 에러 | `issue-fixer` | 버그 수정 |
| 개선해줘, 최적화해줘, 빠르게 | 성능, 품질 | `vibe-implementer` | 개선 구현 |
| 테스트 짜줘, 테스트해줘 | 테스트 | `test-generator` | 테스트 작성 |

---

## 질문/탐색 계열

| 키워드 | 컨텍스트 | 처리 방식 | 설명 |
|--------|----------|-----------|------|
| 어떻게 해?, 가능해?, 좋을까? | 기술 자문 | `architect` | 기술 결정 지원 |
| 뭐가 필요해?, 정리해줘 | 요구사항 | `planner` | 요구사항 명확화 |
| 설명해줘, 알려줘 | 단순 질문 | 직접 답변 | 에이전트 불필요 |
| 찾아줘, 어디있어 | 코드 탐색 | 직접 Grep/Glob | 에이전트 불필요 |

---

## 세션/작업 계열

| 키워드 | 컨텍스트 | 에이전트 | 설명 |
|--------|----------|----------|------|
| 이어서, 계속, 아까 하던거 | 세션 복원 | `task-manager` | 작업 복원 |
| 커밋해줘, push해줘 | Git 작업 | `git-guardian` | Git 워크플로우 |
| 문서 업데이트 | 구현 완료 후 | `docs-sync` | 내부 문서 동기화 |
| README 업데이트 | Public API 변경 | `readme-sync` | README 동기화 |

---

## 복합 키워드 우선순위

동일 동사에 여러 컨텍스트가 해당될 때:

1. **구체적 컨텍스트 우선**: "타입 검증해줘" → `type-sync-checker`
2. **파일 경로 기반**: `masking.ts` 언급 → `security-validator`
3. **최근 작업 기반**: 테스트 작성 직후 "검증해줘" → `test-quality-validator`
4. **폴백**: 컨텍스트 불명확 → `pm-orchestrator` 판단

---

## 네거티브 룰 (에이전트 불필요)

| 요청 유형 | 처리 방식 | 이유 |
|-----------|-----------|------|
| 단순 질문/설명 | 직접 답변 | 오버헤드 불필요 |
| 파일 읽기만 | 직접 Read | 단순 작업 |
| 간단한 검색 | 직접 Grep/Glob | 단순 작업 |
| Git 상태 확인 | 직접 Bash | 단순 명령 |

---

## 자동 트리거 (작업 완료 시)

| 트리거 조건 | 에이전트 | 동작 |
|-------------|----------|------|
| 코드 변경 완료 | `code-reviewer` | 자동 리뷰 |
| 테스트 작성 완료 | `test-quality-validator` | 품질 검증 |
| `types.ts` 수정 | `type-sync-checker` | 동기화 검증 |
| `masking.ts` 수정 | `security-validator` | 보안 검증 |
| `api/` 폴더 수정 | `vercel-constraint-checker` | 제약 검증 |
| 구현 완료 | `docs-sync` | 문서 동기화 |
| Public API 변경 | `readme-sync` | README 업데이트 |
| 에이전트 생성/수정 | `agent-manager` | 등록 및 검증 |
| 컨텍스트 50%+ | `context-optimizer` | 메모리 최적화 |

---

## 사용 예시

```
사용자: "코드 검토해줘"
→ 동사: 검토 + 컨텍스트: 코드 → code-reviewer ✅

사용자: "타입 검증해줘"
→ 동사: 검증 + 컨텍스트: 타입 → type-sync-checker ✅

사용자: "이 함수 있는지 확인해줘"
→ 동사: 확인 + 컨텍스트: 코드 존재 → 직접 Grep ✅

사용자: "에이전트 상태 확인해줘"
→ 동사: 확인 + 컨텍스트: 에이전트 → agent-manager ✅

사용자: "검증해줘" (컨텍스트 불명확)
→ pm-orchestrator가 대화 맥락 분석 후 결정
```

---

## 프로젝트별 확장

이 파일은 범용 규칙입니다. 프로젝트 특화 규칙은 `CLAUDE.md`에서 오버라이드:

```markdown
# CLAUDE.md 예시

## 프로젝트 특화 라우팅

| 키워드 | 에이전트 | 이유 |
|--------|----------|------|
| 마스킹 검증 | `security-validator` | inner-lens 특화 |
| API 페이로드 | `api-integration` | inner-lens 특화 |
```
